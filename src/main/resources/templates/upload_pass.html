<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title>Upload file</title>

    <link href="/css/lib/bootstrap.css" rel="stylesheet"/>
    <link rel="stylesheet" href="/css/bootstrap.min.css" />
    <link rel="stylesheet" href="/css/bootstrap-treeview.css" />
    <link rel="stylesheet" type="text/css" href="/css/temp.css" />
    <!-- Required Stylesheets -->
    <!--<link href="/css/lib/bootstrap.css" rel="stylesheet"/>-->

    <!-- Required Javascript -->

</head>
<body>


        <nav class="navbar navbar-inverse navbar-fixed-top">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="#">MetProt</a>
                </div>
                <div id="navbar" class="navbar-collapse collapse">
                    <ul class="nav navbar-nav navbar-right">
                        <li><a href="#">About</a></li>
                        <li><a href="#">Contact</a></li>
                    </ul>
                </div>
            </div>
        </nav>

        <div class="container-fluid">
            <div class="row">
                <div class="col-sm-3 col-md-2 sidebar">
                    <ul class="nav nav-sidebar">
                        <li><a href="/upload">Upload Data</a></li>
                        <li class="active"><a href="#">Preprocessing<span class="sr-only">(current)</span></a></li>
                        <li><a href="../analysis">Analysis</a></li>
                        <li><a href="#">Annotation</a></li>
                        <li><a href="">Integration</a></li>
                        <li><a href="">Summary</a></li>
                    </ul>
                </div>
                <!--<div class="col-sm-6 col-sm-offset-3 col-md-8 col-md-offset-2 main">-->
                <div class="col-sm-6 col-sm-offset-3 col-md-8 col-md-offset-2 main">
                    <div id="window" style="margin-bottom:15px">
                        <div id="missing-value-estimation" class="processing-section active" data-section-index="1">
                            <h1>Handle missing values</h1>
                            <div class="section">
                                <div>
                                    <form id="mve-form">
                                        <div class="form-group">
                                            <h5><input id="remove-threshold-checkbox" type="checkbox" /> Remove features with too many missing values:</h5>
                                            <input id="remove-threshold" type="text" value="50" /> %
                                        </div>
                                        <div class="form-group">
                                            <h5>Estimate remaining missing values:</h5>
                                            <select id="estimate-mv">
                                                <option value="replace">Replace by a small value (half of the minimum positive value in the original data)</option>
                                                <option value="exclude">Exclude variables with missing values</option>
                                            </select>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>

                        <div id="normalization" class="processing-section" data-section-index="2">
                            <h2>Normalization</h2>
                            <div class="section">
                                <div>
                                    <form id="normalization-form">
                                        <div class="form-group">
                                            <h5>Sample normalization:</h5>
                                            <input id="none" type="radio" value="none" name="norm-by" checked="checked" />
                                            <label for="none">None</label>
                                            <br />
                                            <input id="sum" type="radio" value="sum" name="norm-by" />
                                            <label for="sum">Normalization by sum</label>
                                            <br />
                                            <input id="median" type="radio" value="median" name="norm-by" />
                                            <label for="median">Normalization by median</label>
                                            <br />
                                            <input id="spec-ref-sample" type="radio" value="srs" name="norm-by" />
                                            <label for="spec-ref-sample">Norm. by specific reference sample</label>
                                            <br />
                                            <input id="ref-feature" type="radio" value="rf" name="norm-by" />
                                            <label for="ref-feature">Norm. by reference feature</label>
                                        </div>

                                        <div class="form-group">
                                            <h5>Data transformation:</h5>
                                            <input id="none-trans" type="radio" value="none" name="trans" checked="checked" />
                                            <label for="none-trans">None</label>
                                            <br/>

                                            <input id="log-trans" type="radio" value="log-trans" name="trans" />
                                            <label for="log-trans">Log transformation</label>
                                            <br />

                                            <input id="cube-root-trans" type="radio" value="cube-root-trans" name="trans" />
                                            <label for="cube-root-trans">Cube root transformation</label>

                                        </div>

                                        <div class="form-group">
                                            <h5>Data scaling:</h5>
                                            <input id="none-scaling" type="radio" value="none" name="scaling" checked="checked" />
                                            <label for="none-scaling">None</label>
                                            <br/>

                                            <input id="mean-centered" type="radio" value="mean-centered" name="scaling" />
                                            <label for="mean-centered">Mean centering</label>
                                            <br />

                                            <input id="pareto" type="radio" value="pareto" name="scaling" />
                                            <label for="pareto">Pareto scaling</label>
                                        </div>

                                        <input type="submit" value="Process" class="btn btn-default" />
                                    </form>
                                </div>
                            </div>
                        </div>

                        <!--<div id="analyze" class="processing-section" data-section-index="3">-->
                            <!--<h2><span class="badge">3</span> Analyze</h2>-->
                            <!--<div class="section">-->
                                <!--<div class="row">-->
                                    <!--<div class="col-sm-6 card">-->
                                        <!--<div class="card-text">-->
                                            <!--Metabolite-analysis-->
                                        <!--</div>-->
                                    <!--</div>-->
                                    <!--<div class="col-sm-6 card">-->
                                        <!--<div class="card-text">-->
                                            <!--Temporal pattern recognition-->
                                        <!--</div>-->
                                    <!--</div>-->
                                <!--</div>-->
                            <!--</div>-->
                        <!--</div>-->

                        <div id="section-navigation" class="text-center">
                            <span class="navigation-tool prev invisible"><i class="fa fa-arrow-left fa-3x"></i></span>
                            <span style="margin: 0 15px"></span>
                            <span class="navigation-tool next"><i class="fa fa-arrow-right fa-3x"></i></span>
                        </div>
                    </div>
                </div>
                <div class="col-sm-3 col-md-2">
                    <div id="treeview"/>
                </div>
            </div>
        </div>


        <div th:include="fragments/footer :: footer"></div>

        <script type="text/javascript" src="/js/lib/jquery-3.1.0.min.js"></script>
        <script type="text/javascript" src="/js/lib/bootstrap.min.js"></script>
        <script src="/js/lib/jquery.js"></script>
        <script src="/js/bootstrap-treeview.js"></script>
        <script type="text/javascript">
            function buildDomTree() {

                var data = [];
                var array = localStorage.getItem("root").split(",");

                function walk(nodes, data) {
                    if (!nodes) { return; }
                    $.each(nodes, function (id, node) {
                        var obj = {
                            id: id,
                            // text: "file"+id,
                            text: node.nodeName,
                            tags: [node.childElementCount > 0 ? node.childElementCount + ' child elements' : '']
                        };
                        if (array.length > 0) {
                            obj.nodes = [];
                            array = array.slice(1)
                            walk(array, obj.nodes);
                        }
                        data.push(obj);
                    });
                }

                walk(array, data);
                return data;
            }

//            function prevFile() {
//
//                var data = [];
//                var array = localStorage.getItem("root").split(",");
//
//                function walk(nodes, data) {
//                    if (!nodes) { return; }
//                    $.each(nodes, function (id, node) {
//                        var obj = {
//                            id: id,
//                            // text: "file"+id,
//                            text: node.nodeName,
//                            tags: [node.childElementCount > 0 ? node.childElementCount + ' child elements' : '']
//                        };
//                        if (array.length > 0) {
//                            obj.nodes = [];
//                            array = array.slice(1)
//                            walk(array, obj.nodes);
//                        }
//                        data.push(obj);
//                    });
//                }
//
//                walk(array, data);
//                return data;
//            }
//
//            $(function() {
//                //file tree
//                var options = {
//                    bootstrap2: false,
//                    showTags: false,
//                    levels: 5,
//                    data: prevFile()//[0,"you"]localStorage.getItem("root")
//                };
//
//                $('#treeview').treeview(options);
//            });

            /*<![CDATA[*/
            $(function() {

            // form events

                $('#normalization-form').on("submit", function(e) {
                    e.preventDefault();
                    var a = localStorage.getItem("root");
                    console.log(a);
                    var toAdd = a + "PP_" + a;
                    localStorage.setItem("root", toAdd);
                    console.log(localStorage.getItem("root"));
                    console.log("process mve");
                    console.log("process normalization");

                    $(function() {
                        //file tree
                        var options = {
                            bootstrap2: false,
                            showTags: false,
                            levels: 5,
                            data: buildDomTree()//[0,"you"]localStorage.getItem("root")
                        };

                        $('#treeview').treeview(options);
                    });
                });


            });
            /*]]>*/
        </script>
    </body>
</html>